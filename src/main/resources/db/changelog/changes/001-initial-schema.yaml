databaseChangeLog:

  - changeSet:
      id: 1
      author: ecommerce
      changes:
        - createTable:
            tableName: users
            columns:
              - column:
                  name: id
                  type: BIGINT
                  autoIncrement: true
                  constraints:
                    primaryKey: true
                    nullable: false

              - column:
                  name: username
                  type: VARCHAR(50)
                  constraints:
                    nullable: false
                    unique: true

              - column:
                  name: password
                  type: VARCHAR(255)
                  constraints:
                    nullable: false

              - column:
                  name: email
                  type: VARCHAR(100)
                  constraints:
                    nullable: false
                    unique: true

              - column:
                  name: role
                  type: VARCHAR(20)
                  constraints:
                    nullable: false

              - column:
                  name: is_active
                  type: BOOLEAN
                  defaultValueBoolean: true
                  constraints:
                    nullable: false

              - column:
                  name: created_at
                  type: TIMESTAMP
                  constraints:
                    nullable: false

              - column:
                  name: updated_at
                  type: TIMESTAMP
                  constraints:
                    nullable: false

        - createIndex:
            tableName: users
            indexName: idx_users_username
            columns:
              - column:
                  name: username

        - createIndex:
            tableName: users
            indexName: idx_users_email
            columns:
              - column:
                  name: email

  - changeSet:
      id: 2
      author: ecommerce
      changes:
        - createTable:
            tableName: products
            columns:
              - column:
                  name: id
                  type: BIGINT
                  autoIncrement: true
                  constraints:
                    primaryKey: true
                    nullable: false

              - column:
                  name: name
                  type: VARCHAR(100)
                  constraints:
                    nullable: false

              - column:
                  name: description
                  type: TEXT

              - column:
                  name: price
                  type: DECIMAL(10,2)
                  constraints:
                    nullable: false

              - column:
                  name: quantity
                  type: INT
                  constraints:
                    nullable: false

              - column:
                  name: is_deleted
                  type: BOOLEAN
                  defaultValueBoolean: false
                  constraints:
                    nullable: false

              - column:
                  name: created_at
                  type: TIMESTAMP
                  constraints:
                    nullable: false

              - column:
                  name: updated_at
                  type: TIMESTAMP
                  constraints:
                    nullable: false

        - createIndex:
            tableName: products
            indexName: idx_products_name
            columns:
              - column:
                  name: name

        - createIndex:
            tableName: products
            indexName: idx_products_price
            columns:
              - column:
                  name: price

        - createIndex:
            tableName: products
            indexName: idx_products_is_deleted
            columns:
              - column:
                  name: is_deleted

  - changeSet:
      id: 3
      author: ecommerce
      changes:
        - createTable:
            tableName: orders
            columns:
              - column:
                  name: id
                  type: BIGINT
                  autoIncrement: true
                  constraints:
                    primaryKey: true
                    nullable: false

              - column:
                  name: user_id
                  type: BIGINT
                  constraints:
                    nullable: false
                    foreignKeyName: fk_orders_user_id
                    referencedTableName: users
                    referencedColumnNames: id

              - column:
                  name: order_total
                  type: DECIMAL(10,2)
                  constraints:
                    nullable: false

              - column:
                  name: discount_amount
                  type: DECIMAL(10,2)
                  defaultValueNumeric: 0.00
                  constraints:
                    nullable: false

              - column:
                  name: final_amount
                  type: DECIMAL(10,2)
                  constraints:
                    nullable: false

              - column:
                  name: status
                  type: VARCHAR(20)
                  constraints:
                    nullable: false

              - column:
                  name: created_at
                  type: TIMESTAMP
                  constraints:
                    nullable: false

        - createIndex:
            tableName: orders
            indexName: idx_orders_user_id
            columns:
              - column:
                  name: user_id

        - createIndex:
            tableName: orders
            indexName: idx_orders_status
            columns:
              - column:
                  name: status

        - createIndex:
            tableName: orders
            indexName: idx_orders_created_at
            columns:
              - column:
                  name: created_at

  - changeSet:
      id: 4
      author: ecommerce
      changes:
        - createTable:
            tableName: order_items
            columns:
              - column:
                  name: id
                  type: BIGINT
                  autoIncrement: true
                  constraints:
                    primaryKey: true
                    nullable: false

              - column:
                  name: order_id
                  type: BIGINT
                  constraints:
                    nullable: false
                    foreignKeyName: fk_order_items_order_id
                    referencedTableName: orders
                    referencedColumnNames: id

              - column:
                  name: product_id
                  type: BIGINT
                  constraints:
                    nullable: false
                    foreignKeyName: fk_order_items_product_id
                    referencedTableName: products
                    referencedColumnNames: id

              - column:
                  name: quantity
                  type: INT
                  constraints:
                    nullable: false

              - column:
                  name: unit_price
                  type: DECIMAL(10,2)
                  constraints:
                    nullable: false

         

              - column:
                  name: total_price
                  type: DECIMAL(10,2)
                  constraints:
                    nullable: false

        - createIndex:
            tableName: order_items
            indexName: idx_order_items_order_id
            columns:
              - column:
                  name: order_id

        - createIndex:
            tableName: order_items
            indexName: idx_order_items_product_id
            columns:
              - column:
                  name: product_id

  - changeSet:
      id: 5
      author: ecommerce
      changes:
        - insert:
            tableName: users
            columns:
              - column: { name: username, value: admin }
              - column: { name: password, value: "$2a$10$XURPShQNCsLjp1ESc2laoObo9QZDhxz73hJPaEv7/cBha4pk0AgP6" }
              - column: { name: email, value: admin@example.com }
              - column: { name: role, value: ADMIN }
              - column: { name: created_at, valueComputed: CURRENT_TIMESTAMP }
              - column: { name: updated_at, valueComputed: CURRENT_TIMESTAMP }

        - insert:
            tableName: users
            columns:
              - column: { name: username, value: premium_user }
              - column: { name: password, value: "$2a$10$XURPShQNCsLjp1ESc2laoObo9QZDhxz73hJPaEv7/cBha4pk0AgP6" }
              - column: { name: email, value: premium@example.com }
              - column: { name: role, value: PREMIUM_USER }
              - column: { name: created_at, valueComputed: CURRENT_TIMESTAMP }
              - column: { name: updated_at, valueComputed: CURRENT_TIMESTAMP }

        - insert:
            tableName: users
            columns:
              - column: { name: username, value: regular_user }
              - column: { name: password, value: "$2a$10$XURPShQNCsLjp1ESc2laoObo9QZDhxz73hJPaEv7/cBha4pk0AgP6" }
              - column: { name: email, value: user@example.com }
              - column: { name: role, value: USER }
              - column: { name: created_at, valueComputed: CURRENT_TIMESTAMP }
              - column: { name: updated_at, valueComputed: CURRENT_TIMESTAMP }

  - changeSet:
      id: 6
      author: ecommerce
      changes:
        - insert:
            tableName: products
            columns:
              - column: { name: name, value: iPhone 15 Pro }
              - column: { name: description, value: "Latest Apple smartphone with A17 Pro chip" }
              - column: { name: price, valueNumeric: 999.99 }
              - column: { name: quantity, valueNumeric: 50 }
              - column: { name: created_at, valueComputed: CURRENT_TIMESTAMP }
              - column: { name: updated_at, valueComputed: CURRENT_TIMESTAMP }

        - insert:
            tableName: products
            columns:
              - column: { name: name, value: MacBook Pro 16 }
              - column: { name: description, value: "Professional laptop with M3 Max chip" }
              - column: { name: price, valueNumeric: 2499.99 }
              - column: { name: quantity, valueNumeric: 25 }
              - column: { name: created_at, valueComputed: CURRENT_TIMESTAMP }
              - column: { name: updated_at, valueComputed: CURRENT_TIMESTAMP }

        - insert:
            tableName: products
            columns:
              - column: { name: name, value: AirPods Pro }
              - column: { name: description, value: "Wireless earbuds with noise cancellation" }
              - column: { name: price, valueNumeric: 249.99 }
              - column: { name: quantity, valueNumeric: 100 }
              - column: { name: created_at, valueComputed: CURRENT_TIMESTAMP }
              - column: { name: updated_at, valueComputed: CURRENT_TIMESTAMP }

        - insert:
            tableName: products
            columns:
              - column: { name: name, value: iPad Air }
              - column: { name: description, value: "Thin and light tablet with M1 chip" }
              - column: { name: price, valueNumeric: 599.99 }
              - column: { name: quantity, valueNumeric: 75 }
              - column: { name: created_at, valueComputed: CURRENT_TIMESTAMP }
              - column: { name: updated_at, valueComputed: CURRENT_TIMESTAMP }

        - insert:
            tableName: products
            columns:
              - column: { name: name, value: Apple Watch Series 9 }
              - column: { name: description, value: "Advanced smartwatch with health features" }
              - column: { name: price, valueNumeric: 399.99 }
              - column: { name: quantity, valueNumeric: 60 }
              - column: { name: created_at, valueComputed: CURRENT_TIMESTAMP }
              - column: { name: updated_at, valueComputed: CURRENT_TIMESTAMP }
